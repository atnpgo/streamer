{
    "version": 3,
    "sources": [
        "main.es6"
    ],
    "names": [
        "server",
        "janus",
        "screentest",
        "opaqueId",
        "Janus",
        "randomString",
        "myusername",
        "myid",
        "capture",
        "role",
        "room",
        "source",
        "spinner",
        "checkEnterShare",
        "field",
        "event",
        "theCode",
        "keyCode",
        "which",
        "charCode",
        "preShareScreen",
        "isExtensionEnabled",
        "alert",
        "$",
        "val",
        "navigator",
        "mozGetUserMedia",
        "shareScreen",
        "desc",
        "create",
        "send",
        "success",
        "result",
        "debug",
        "undefined",
        "log",
        "register",
        "history",
        "pushState",
        "document",
        "querySelector",
        "classList",
        "add",
        "modal",
        "joinScreen",
        "roomid",
        "isNaN",
        "parseInt",
        "buildRoom",
        "newRemoteFeed",
        "id",
        "display",
        "remoteFeed",
        "attach",
        "plugin",
        "pluginHandle",
        "getPlugin",
        "getId",
        "listen",
        "error",
        "onmessage",
        "msg",
        "jsep",
        "toggleClass",
        "createAnswer",
        "media",
        "audioSend",
        "videoSend",
        "body",
        "onlocalstream",
        "stream",
        "onremotestream",
        "length",
        "append",
        "bind",
        "remove",
        "removeClass",
        "stop",
        "attachMediaStream",
        "get",
        "oncleanup",
        "len",
        "charSet",
        "i",
        "randomPoz",
        "Math",
        "floor",
        "random",
        "substring",
        "addSizeToGoogleProfilePic",
        "url",
        "indexOf",
        "getProfilePicUrl",
        "firebase",
        "auth",
        "currentUser",
        "photoURL",
        "getUserName",
        "displayName",
        "saveMessage",
        "messageText",
        "firestore",
        "collection",
        "name",
        "text",
        "profilePicUrl",
        "timestamp",
        "FieldValue",
        "serverTimestamp",
        "console",
        "saveImageMessage",
        "file",
        "imageUrl",
        "then",
        "messageRef",
        "storage",
        "ref",
        "uid",
        "put",
        "fileSnapshot",
        "getDownloadURL",
        "update",
        "storageUri",
        "metadata",
        "fullPath",
        "deleteMessage",
        "div",
        "getElementById",
        "parentNode",
        "removeChild",
        "displayMessage",
        "picUrl",
        "messageListElement",
        "container",
        "createElement",
        "innerHTML",
        "firstChild",
        "setAttribute",
        "appendChild",
        "style",
        "backgroundImage",
        "textContent",
        "messageElement",
        "replace",
        "image",
        "addEventListener",
        "scrollTop",
        "scrollHeight",
        "src",
        "Date",
        "getTime",
        "setTimeout",
        "focus",
        "$btnSignIn",
        "click",
        "signInWithPopup",
        "GoogleAuthProvider",
        "$btnSignOut",
        "signOut",
        "hide",
        "show",
        "onAuthStateChanged",
        "user",
        "removeAttr",
        "attr",
        "e",
        "preventDefault",
        "stopPropagation",
        "input",
        "type",
        "accept",
        "onchange",
        "target",
        "files",
        "match",
        "submit",
        "message",
        "currentTarget",
        "value",
        "toggle",
        "active",
        "fullscreenElement",
        "fullscreen",
        "webkitIsFullScreen",
        "mozIsFullScreen",
        "msIsFullScreen",
        "$btnFullscreen",
        "exitFullscreen",
        "webkitExitFullscreen",
        "mozExitFullscreen",
        "msExitFullscreen",
        "requestFullscreen",
        "webkitRequestFullscreen",
        "mozRequestFullscreen",
        "msRequestFullscreen",
        "query",
        "orderBy",
        "limit",
        "onSnapshot",
        "snapshot",
        "docChanges",
        "forEach",
        "change",
        "doc",
        "data",
        "init",
        "callback",
        "isWebrtcSupported",
        "consentDialog",
        "on",
        "webrtcState",
        "destroy",
        "html",
        "createOffer",
        "video",
        "videoRecv",
        "publish",
        "JSON",
        "stringify",
        "list",
        "f",
        "leaving",
        "handleRemoteJsep",
        "empty",
        "destroyed",
        "window",
        "location",
        "hash",
        "backdrop",
        "keyboard"
    ],
    "mappings": "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",
    "sourcesContent": [
        "var server = null;\n//if (window.location.protocol === 'http:')\n//  server = \"http://\" + window.location.hostname + \":8088/janus\";\n//else\nserver = \"https://stream.atnpgo.wtf:8089/janus\";\n\n\nvar janus = null;\nvar screentest = null;\nvar opaqueId = \"screensharingtest-\" + Janus.randomString(12);\n\nvar myusername = null;\nvar myid = null;\n\nvar capture = null;\nvar role = null;\nvar room = null;\nvar source = null;\n\nvar spinner = null;\n\n\nfunction checkEnterShare(field, event) {\n    var theCode = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;\n    if (theCode == 13) {\n        preShareScreen();\n        return false;\n    } else {\n        return true;\n    }\n}\n\nfunction preShareScreen() {\n    if (!Janus.isExtensionEnabled()) {\n        alert(\"You're using Chrome but don't have the screensharing extension installed: click <b><a href='https://chrome.google.com/webstore/detail/janus-webrtc-screensharin/hapfgfdkleiggjjpfpenajgdnfckjpaj' target='_blank'>here</a></b> to do so\");\n        return;\n    }\n    // Create a new room\n    if ($('#desc').val() === \"\") {\n        alert(\"Please insert a description for the room\");\n        return;\n    }\n    capture = \"screen\";\n    if (navigator.mozGetUserMedia) {\n        // Firefox needs a different constraint for screen and window sharing\n        capture = \"window\";\n        shareScreen();\n    } else {\n        shareScreen();\n    }\n}\n\nfunction shareScreen() {\n    // Create a new room\n    var desc = $('#desc').val();\n    role = \"publisher\";\n\n    var create = {\"request\": \"create\", \"description\": desc, \"bitrate\": 1000000, \"publishers\": 1};\n    screentest.send({\n        \"message\": create, success: function (result) {\n            var event = result[\"videoroom\"];\n            Janus.debug(\"Event: \" + event);\n            if (event != undefined && event != null) {\n                // Our own screen sharing session has been created, join it\n                room = result[\"room\"];\n                Janus.log(\"Screen sharing session created: \" + room);\n                myusername = randomString(12);\n                var register = {\"request\": \"join\", \"room\": room, \"ptype\": \"publisher\", \"display\": myusername};\n                screentest.send({\"message\": register});\n                history.pushState({}, room, \"#\" + room);\n                document.querySelector('#container').classList.add('visible');\n                $('#no-stream-modal').modal('hide');\n            }\n        }\n    });\n}\n\nfunction joinScreen(roomid) {\n    // Join an existing screen sharing session\n    if (isNaN(roomid)) {\n        history.pushState({}, '', \"\");\n        return;\n    }\n    room = parseInt(roomid);\n    role = \"listener\";\n    myusername = randomString(12);\n    var register = {\"request\": \"join\", \"room\": room, \"ptype\": \"listener\", \"display\": myusername};\n    screentest.send({\"message\": register});\n    buildRoom(room);\n}\n\nfunction newRemoteFeed(id, display) {\n    // A new feed has been published, create a new plugin handle and attach to it as a listener\n    source = id;\n    var remoteFeed = null;\n    janus.attach(\n        {\n            plugin: \"janus.plugin.videoroom\",\n            opaqueId: opaqueId,\n            success: function (pluginHandle) {\n                remoteFeed = pluginHandle;\n                Janus.log(\"Plugin attached! (\" + remoteFeed.getPlugin() + \", id=\" + remoteFeed.getId() + \")\");\n                Janus.log(\"  -- This is a subscriber\");\n                // We wait for the plugin to send us an offer\n                var listen = {\"request\": \"join\", \"room\": room, \"ptype\": \"listener\", \"feed\": id};\n                remoteFeed.send({\"message\": listen});\n            },\n            error: function (error) {\n                Janus.error(\"  -- Error attaching plugin...\", error);\n                alert(\"Error attaching plugin... \" + error);\n            },\n            onmessage: function (msg, jsep) {\n                Janus.debug(\" ::: Got a message (listener) :::\");\n                Janus.debug(msg);\n                var event = msg[\"videoroom\"];\n                Janus.debug(\"Event: \" + event);\n                if (event != undefined && event != null) {\n                    if (event === \"attached\") {\n                        Janus.log(\"Successfully attached to feed \" + id + \" (\" + display + \") in room \" + msg[\"room\"]);\n                        $('#screenmenu').toggleClass('d-flex d-none');\n                        $('#room').toggleClass('d-flex d-none');\n                    } else {\n                        // What has just happened?\n                    }\n                }\n                if (jsep !== undefined && jsep !== null) {\n                    Janus.debug(\"Handling SDP as well...\");\n                    Janus.debug(jsep);\n                    // Answer and attach\n                    remoteFeed.createAnswer(\n                        {\n                            jsep: jsep,\n                            media: {audioSend: false, videoSend: false},\t// We want recvonly audio/video\n                            success: function (jsep) {\n                                Janus.debug(\"Got SDP!\");\n                                Janus.debug(jsep);\n                                var body = {\"request\": \"start\", \"room\": room};\n                                remoteFeed.send({\"message\": body, \"jsep\": jsep});\n                            },\n                            error: function (error) {\n                                Janus.error(\"WebRTC error:\", error);\n                                alert(\"WebRTC error... \" + error);\n                            }\n                        });\n                }\n            },\n            onlocalstream: function (stream) {\n                // The subscriber stream is recvonly, we don't expect anything here\n            },\n            onremotestream: function (stream) {\n                if ($('#screenvideo').length === 0) {\n                    // No remote video yet\n                    $('#screencapture').append('<video class=\"rounded centered\" id=\"waitingvideo\" width=\"100%\" height=\"100%\" />');\n                    $('#screencapture').append('<video class=\"rounded centered hide\" id=\"screenvideo\" width=\"100%\" height=\"100%\" autoplay playsinline/>');\n                    // Show the video, hide the spinner and show the resolution when we get a playing event\n                    $(\"#screenvideo\").bind(\"playing\", function () {\n                        $('#waitingvideo').remove();\n                        $('#screenvideo').removeClass('hide');\n                        if (spinner !== null && spinner !== undefined)\n                            spinner.stop();\n                        spinner = null;\n                    });\n                }\n                Janus.attachMediaStream($('#screenvideo').get(0), stream);\n            },\n            oncleanup: function () {\n                Janus.log(\" ::: Got a cleanup notification (remote feed \" + id + \") :::\");\n                $('#waitingvideo').remove();\n                if (spinner !== null && spinner !== undefined)\n                    spinner.stop();\n                spinner = null;\n            }\n        });\n}\n\n// Just an helper to generate random usernames\nfunction randomString(len, charSet) {\n    charSet = charSet || 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var randomString = '';\n    for (var i = 0; i < len; i++) {\n        var randomPoz = Math.floor(Math.random() * charSet.length);\n        randomString += charSet.substring(randomPoz, randomPoz + 1);\n    }\n    return randomString;\n}\n\nconst buildRoom = room => {\n    const addSizeToGoogleProfilePic = url => url.indexOf('googleusercontent.com') !== -1 && url.indexOf('?') === -1 ? url + '?sz=150' : url;\n    const getProfilePicUrl = () => firebase.auth().currentUser.photoURL || 'profile_placeholder.png';\n    const getUserName = () => firebase.auth().currentUser.displayName;\n\n    const saveMessage = messageText => firebase.firestore().collection(room).add({\n        name: getUserName(),\n        text: messageText,\n        profilePicUrl: getProfilePicUrl(),\n        timestamp: firebase.firestore.FieldValue.serverTimestamp()\n    }).catch(error => console.error('Error writing new message to Firebase Database', error));\n\n    const saveImageMessage = file => firebase.firestore().collection(room).add({\n        name: getUserName(),\n        imageUrl: 'https://www.google.com/images/spin-32.gif?a',\n        profilePicUrl: getProfilePicUrl(),\n        timestamp: firebase.firestore.FieldValue.serverTimestamp()\n    }).then(messageRef => firebase.storage().ref(firebase.auth().currentUser.uid + '/' + messageRef.id + '/' + file.name).put(file)\n        .then(fileSnapshot => fileSnapshot.ref.getDownloadURL()\n            .then(url => messageRef.update({\n                imageUrl: url,\n                storageUri: fileSnapshot.metadata.fullPath\n            })))).catch(error => console.error('There was an error uploading a file to Cloud Storage:', error));\n\n    const deleteMessage = id => {\n        const div = document.getElementById(id);\n        if (div) {\n            div.parentNode.removeChild(div);\n        }\n    };\n\n    const displayMessage = (id, timestamp, name, text, picUrl, imageUrl) => {\n        const messageListElement = document.querySelector('.chat');\n        let div = document.getElementById(id);\n        // If an element for that message does not exists yet we create it.\n        if (!div) {\n            const container = document.createElement('div');\n            container.innerHTML = '<div class=\"message-container\"><div class=\"pic\"></div><div><div class=\"name\"></div><div class=\"message\"></div></div></div>';\n            div = container.firstChild;\n            div.setAttribute('id', id);\n            div.setAttribute('timestamp', timestamp);\n            messageListElement.appendChild(div);\n        }\n        if (picUrl) {\n            div.querySelector('.pic').style.backgroundImage = 'url(' + addSizeToGoogleProfilePic(picUrl) + ')';\n        }\n        div.querySelector('.name').textContent = name;\n        const messageElement = div.querySelector('.message');\n        if (text) { // If the message is text.\n            messageElement.textContent = text;\n            // Replace all line breaks by <br>.\n            messageElement.innerHTML = messageElement.innerHTML.replace(/\\n/g, '<br>');\n        } else if (imageUrl) { // If the message is an image.\n            const image = document.createElement('img');\n            image.addEventListener('load', () => messageListElement.scrollTop = messageListElement.scrollHeight);\n            image.src = imageUrl + '&' + new Date().getTime();\n            messageElement.innerHTML = '';\n            messageElement.appendChild(image);\n        }\n        // Show the card fading-in and scroll to view the new message.\n        setTimeout(() => div.classList.add('visible'), 1);\n        messageListElement.scrollTop = messageListElement.scrollHeight;\n        document.querySelector('input').focus();\n    };\n\n    const $btnSignIn = $('#btn-sign-in').click(() => firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider()));\n    const $btnSignOut = $('#btn-sign-out').click(() => firebase.auth().signOut());\n\n    $btnSignOut.hide();\n    $btnSignIn.show();\n    firebase.auth().onAuthStateChanged(user => {\n        if (user) {\n            $btnSignOut.show();\n            $btnSignIn.hide();\n            $('#form-send-message input').removeAttr('disabled').attr('placeholder', 'Message');\n            $('#form-send-message button').removeAttr('disabled');\n            document.querySelector('#name').innerHTML = getUserName();\n            document.querySelector('#pfp').src = addSizeToGoogleProfilePic(getProfilePicUrl());\n        } else {\n            $btnSignOut.hide();\n            $btnSignIn.show();\n            $('#form-send-message input').attr('disabled', 'disabled').attr('placeholder', 'Please sign in to send messages');\n            $('#form-send-message button').attr('disabled', 'disabled');\n            document.querySelector('#name').innerHTML = 'Please sign in <i class=\"fas fa-arrow-right\"></i>';\n            document.querySelector('#pfp').src = 'profile_placeholder.png';\n        }\n    });\n    $('#btn-add-image').click(e => {\n        e.preventDefault();\n        e.stopPropagation();\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.accept = 'image/png, image/jpeg, image/gif';\n        input.onchange = e => {\n            const file = e.target.files[0];\n            if (!file.type.match('image.*')) {\n                alert('You can only share images');\n                return;\n            }\n            saveImageMessage(file)\n        };\n        input.click();\n    });\n\n    $('#form-send-message').submit(e => {\n        e.preventDefault();\n        e.stopPropagation();\n        const message = e.currentTarget.querySelector('input').value;\n        e.currentTarget.querySelector('input').value = '';\n        saveMessage(message);\n    });\n\n    const toggle = () => $('.fa-expand-arrows-alt,.fa-compress-arrows-alt').toggleClass('fa-expand-arrows-alt fa-compress-arrows-alt');\n    document.addEventListener('fullscreenchange', toggle, false);\n    document.addEventListener('webkitfullscreenchange', toggle, false);\n    document.addEventListener('mozfullscreenchange', toggle, false);\n    document.addEventListener('msfullscreenchange', toggle, false);\n    const active = () => {\n        if (document.fullscreenElement != null) {\n            return true;\n        } else if (document.fullscreen) {\n            return document.fullscreen;\n        } else if (document.webkitIsFullScreen) {\n            return document.webkitIsFullScreen;\n        } else if (document.mozIsFullScreen) {\n            return document.mozIsFullScreen;\n        } else if (document.msIsFullScreen) {\n            return document.msIsFullScreen;\n        } else {\n            return false;\n        }\n    };\n\n    const $btnFullscreen = $('#btn-fullscreen').click(() => {\n        if (active()) {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            } else if (document.mozExitFullscreen) {\n                document.mozExitFullscreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            }\n        } else {\n            if (document.body.requestFullscreen) {\n                document.body.requestFullscreen();\n            } else if (document.body.webkitRequestFullscreen) {\n                document.body.webkitRequestFullscreen();\n            } else if (document.body.mozRequestFullscreen) {\n                document.body.mozRequestFullscreen();\n            } else if (document.body.msRequestFullscreen) {\n                document.body.msRequestFullscreen();\n            } else {\n                $btnFullscreen.hide();\n                alert('Please use your browser\\'s fullscreen.');\n            }\n        }\n    });\n\n    const query = firebase.firestore()\n        .collection(room)\n        .orderBy('timestamp', 'asc')\n        .limit(25);\n    query.onSnapshot(snapshot => snapshot.docChanges().forEach(change => {\n        if (change.type === 'removed') {\n            deleteMessage(change.doc.id);\n        } else {\n            const message = change.doc.data();\n            displayMessage(change.doc.id, message.timestamp, message.name, message.text, message.profilePicUrl, message.imageUrl);\n        }\n    }));\n};\n\n\nJanus.init({\n    debug: \"all\", callback: function () {\n        // Use a button to start the demo\n        // Make sure the browser supports WebRTC\n        if (!Janus.isWebrtcSupported()) {\n            alert(\"No WebRTC support... \");\n            return;\n        }\n        // Create session\n        janus = new Janus(\n            {\n                server: server,\n                success: function () {\n                    // Attach to video room test plugin\n                    janus.attach(\n                        {\n                            plugin: \"janus.plugin.videoroom\",\n                            opaqueId: opaqueId,\n                            success: function (pluginHandle) {\n                                $('#details').remove();\n                                screentest = pluginHandle;\n                                if (room.length > 0) {\n                                    joinScreen(room);\n                                }\n                                Janus.log(\"Plugin attached! (\" + screentest.getPlugin() + \", id=\" + screentest.getId() + \")\");\n                                $('#create').click(preShareScreen);\n                                $('#desc').focus();\n                            },\n                            error: function (error) {\n                                Janus.error(\"  -- Error attaching plugin...\", error);\n                                alert(\"Error attaching plugin... \" + error);\n                            },\n                            consentDialog: function (on) {\n                                Janus.debug(\"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\");\n                            },\n                            webrtcState: function (on) {\n                                Janus.log(\"Janus says our WebRTC PeerConnection is \" + (on ? \"up\" : \"down\") + \" now\");\n                                if (on) {\n                                    //alert(\"Your screen sharing session just started: pass the \" + room + \"session identifier to those who want to attend.\");\n                                    buildRoom(room);\n                                } else {\n                                    alert(\"Your screen sharing session just stopped.\");\n                                    janus.destroy();\n                                }\n                            },\n                            onmessage: function (msg, jsep) {\n                                Janus.debug(\" ::: Got a message (publisher) :::\");\n                                Janus.debug(msg);\n                                var event = msg[\"videoroom\"];\n                                Janus.debug(\"Event: \" + event);\n                                if (event != undefined && event != null) {\n                                    if (event === \"joined\") {\n                                        myid = msg[\"id\"];\n                                        $('#session').html(room);\n                                        $('#title').html(msg[\"description\"]);\n                                        Janus.log(\"Successfully joined room \" + msg[\"room\"] + \" with ID \" + myid);\n                                        if (role === \"publisher\") {\n                                            // This is our session, publish our stream\n                                            Janus.debug(\"Negotiating WebRTC stream for our screen (capture \" + capture + \")\");\n                                            screentest.createOffer(\n                                                {\n                                                    media: {video: capture, audioSend: true, videoRecv: false},\t// Screen sharing Publishers are sendonly\n                                                    success: function (jsep) {\n                                                        Janus.debug(\"Got publisher SDP!\");\n                                                        Janus.debug(jsep);\n                                                        var publish = {\"request\": \"configure\", \"audio\": true, \"video\": true};\n                                                        screentest.send({\"message\": publish, \"jsep\": jsep});\n                                                    },\n                                                    error: function (error) {\n                                                        Janus.error(\"WebRTC error:\", error);\n                                                        alert(\"WebRTC error... \" + JSON.stringify(error));\n                                                    }\n                                                });\n                                        } else {\n                                            // We're just watching a session, any feed to attach to?\n                                            if (msg[\"publishers\"] !== undefined && msg[\"publishers\"] !== null) {\n                                                var list = msg[\"publishers\"];\n                                                Janus.debug(\"Got a list of available publishers/feeds:\");\n                                                Janus.debug(list);\n                                                for (var f in list) {\n                                                    var id = list[f][\"id\"];\n                                                    var display = list[f][\"display\"];\n                                                    Janus.debug(\"  >> [\" + id + \"] \" + display);\n                                                    newRemoteFeed(id, display)\n                                                }\n                                            }\n                                        }\n                                    } else if (event === \"event\") {\n                                        // Any feed to attach to?\n                                        if (role === \"listener\" && msg[\"publishers\"] !== undefined && msg[\"publishers\"] !== null) {\n                                            var list = msg[\"publishers\"];\n                                            Janus.debug(\"Got a list of available publishers/feeds:\");\n                                            Janus.debug(list);\n                                            for (var f in list) {\n                                                var id = list[f][\"id\"];\n                                                var display = list[f][\"display\"];\n                                                Janus.debug(\"  >> [\" + id + \"] \" + display);\n                                                newRemoteFeed(id, display)\n                                            }\n                                        } else if (msg[\"leaving\"] !== undefined && msg[\"leaving\"] !== null) {\n                                            // One of the publishers has gone away?\n                                            var leaving = msg[\"leaving\"];\n                                            Janus.log(\"Publisher left: \" + leaving);\n                                            if (role === \"listener\" && msg[\"leaving\"] === source) {\n                                                alert(\"The screen sharing session is over, the publisher left\");\n                                            }\n                                        } else if (msg[\"error\"] !== undefined && msg[\"error\"] !== null) {\n                                            alert(msg[\"error\"]);\n                                        }\n                                    }\n                                }\n                                if (jsep !== undefined && jsep !== null) {\n                                    Janus.debug(\"Handling SDP as well...\");\n                                    Janus.debug(jsep);\n                                    screentest.handleRemoteJsep({jsep: jsep});\n                                }\n                            },\n                            onlocalstream: function (stream) {\n                                Janus.debug(\" ::: Got a local stream :::\");\n                                Janus.debug(stream);\n                                $('#screenmenu').toggleClass('d-flex d-none');\n                                $('#room').toggleClass('d-flex d-none');\n                                if ($('#screenvideo').length === 0) {\n                                    $('#screencapture').append('<video class=\"rounded centered\" id=\"screenvideo\" width=\"100%\" height=\"100%\" autoplay playsinline muted=\"muted\"/>');\n                                }\n                                Janus.attachMediaStream($('#screenvideo').get(0), stream);\n                            },\n                            onremotestream: function (stream) {\n                                // The publisher stream is sendonly, we don't expect anything here\n                            },\n                            oncleanup: function () {\n                                Janus.log(\" ::: Got a cleanup notification :::\");\n                                $('#screencapture').empty();\n                                $('#room').toggleClass('d-flex d-none');\n                            }\n                        });\n                },\n                error: function (error) {\n                    Janus.error(error);\n                    alert(error);\n                },\n                destroyed: function () {\n                }\n            });\n    }\n});\n\nroom = window.location.hash.substring(1);\nif (room.length === 0) {\n    $('#no-stream-modal').modal({\n        backdrop: 'static',\n        keyboard: false\n    });\n}\n"
    ],
    "file": "main.js"
}
