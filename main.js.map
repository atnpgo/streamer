{
    "version": 3,
    "sources": [
        "main.es6"
    ],
    "names": [
        "buildRoom",
        "room",
        "addSizeToGoogleProfilePic",
        "url",
        "indexOf",
        "getProfilePicUrl",
        "firebase",
        "auth",
        "currentUser",
        "photoURL",
        "getUserName",
        "displayName",
        "saveMessage",
        "messageText",
        "firestore",
        "collection",
        "add",
        "name",
        "text",
        "profilePicUrl",
        "timestamp",
        "FieldValue",
        "serverTimestamp",
        "error",
        "console",
        "saveImageMessage",
        "file",
        "imageUrl",
        "then",
        "messageRef",
        "storage",
        "ref",
        "uid",
        "id",
        "put",
        "fileSnapshot",
        "getDownloadURL",
        "update",
        "storageUri",
        "metadata",
        "fullPath",
        "deleteMessage",
        "div",
        "document",
        "getElementById",
        "parentNode",
        "removeChild",
        "displayMessage",
        "picUrl",
        "messageListElement",
        "querySelector",
        "container",
        "createElement",
        "innerHTML",
        "firstChild",
        "setAttribute",
        "appendChild",
        "style",
        "backgroundImage",
        "textContent",
        "messageElement",
        "replace",
        "image",
        "addEventListener",
        "scrollTop",
        "scrollHeight",
        "src",
        "Date",
        "getTime",
        "setTimeout",
        "classList",
        "focus",
        "$btnSignIn",
        "$",
        "click",
        "signInWithPopup",
        "GoogleAuthProvider",
        "$btnSignOut",
        "signOut",
        "hide",
        "show",
        "onAuthStateChanged",
        "user",
        "removeAttr",
        "attr",
        "e",
        "preventDefault",
        "stopPropagation",
        "input",
        "type",
        "accept",
        "onchange",
        "target",
        "files",
        "match",
        "alert",
        "submit",
        "message",
        "currentTarget",
        "value",
        "toggle",
        "toggleClass",
        "active",
        "fullscreenElement",
        "fullscreen",
        "webkitIsFullScreen",
        "mozIsFullScreen",
        "msIsFullScreen",
        "$btnFullscreen",
        "exitFullscreen",
        "webkitExitFullscreen",
        "mozExitFullscreen",
        "msExitFullscreen",
        "body",
        "requestFullscreen",
        "webkitRequestFullscreen",
        "mozRequestFullscreen",
        "msRequestFullscreen",
        "query",
        "orderBy",
        "limit",
        "onSnapshot",
        "snapshot",
        "docChanges",
        "forEach",
        "change",
        "doc",
        "data",
        "window",
        "location",
        "hash",
        "substring",
        "length",
        "$modal",
        "modal",
        "backdrop",
        "keyboard",
        "stream",
        "history",
        "pushState",
        "on"
    ],
    "mappings": "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",
    "sourcesContent": [
        "(() => {\n    const buildRoom = room => {\n\n        const addSizeToGoogleProfilePic = url => url.indexOf('googleusercontent.com') !== -1 && url.indexOf('?') === -1 ? url + '?sz=150' : url;\n        const getProfilePicUrl = () => firebase.auth().currentUser.photoURL || 'profile_placeholder.png';\n        const getUserName = () => firebase.auth().currentUser.displayName;\n\n        const saveMessage = messageText => firebase.firestore().collection(room).add({\n            name: getUserName(),\n            text: messageText,\n            profilePicUrl: getProfilePicUrl(),\n            timestamp: firebase.firestore.FieldValue.serverTimestamp()\n        }).catch(error => console.error('Error writing new message to Firebase Database', error));\n\n        const saveImageMessage = file => firebase.firestore().collection(room).add({\n            name: getUserName(),\n            imageUrl: 'https://www.google.com/images/spin-32.gif?a',\n            profilePicUrl: getProfilePicUrl(),\n            timestamp: firebase.firestore.FieldValue.serverTimestamp()\n        }).then(messageRef => firebase.storage().ref(firebase.auth().currentUser.uid + '/' + messageRef.id + '/' + file.name).put(file)\n            .then(fileSnapshot => fileSnapshot.ref.getDownloadURL()\n                .then(url => messageRef.update({\n                    imageUrl: url,\n                    storageUri: fileSnapshot.metadata.fullPath\n                })))).catch(error => console.error('There was an error uploading a file to Cloud Storage:', error));\n\n        const deleteMessage = id => {\n            const div = document.getElementById(id);\n            if (div) {\n                div.parentNode.removeChild(div);\n            }\n        };\n\n        const displayMessage = (id, timestamp, name, text, picUrl, imageUrl) => {\n            const messageListElement = document.querySelector('.chat');\n            let div = document.getElementById(id);\n            // If an element for that message does not exists yet we create it.\n            if (!div) {\n                const container = document.createElement('div');\n                container.innerHTML = '<div class=\"message-container\"><div class=\"pic\"></div><div><div class=\"name\"></div><div class=\"message\"></div></div></div>';\n                div = container.firstChild;\n                div.setAttribute('id', id);\n                div.setAttribute('timestamp', timestamp);\n                messageListElement.appendChild(div);\n            }\n            if (picUrl) {\n                div.querySelector('.pic').style.backgroundImage = 'url(' + addSizeToGoogleProfilePic(picUrl) + ')';\n            }\n            div.querySelector('.name').textContent = name;\n            const messageElement = div.querySelector('.message');\n            if (text) { // If the message is text.\n                messageElement.textContent = text;\n                // Replace all line breaks by <br>.\n                messageElement.innerHTML = messageElement.innerHTML.replace(/\\n/g, '<br>');\n            } else if (imageUrl) { // If the message is an image.\n                const image = document.createElement('img');\n                image.addEventListener('load', () => messageListElement.scrollTop = messageListElement.scrollHeight);\n                image.src = imageUrl + '&' + new Date().getTime();\n                messageElement.innerHTML = '';\n                messageElement.appendChild(image);\n            }\n            // Show the card fading-in and scroll to view the new message.\n            setTimeout(() => div.classList.add('visible'), 1);\n            messageListElement.scrollTop = messageListElement.scrollHeight;\n            document.querySelector('input').focus();\n        };\n\n        const $btnSignIn = $('#btn-sign-in').click(() => firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider()));\n        const $btnSignOut = $('#btn-sign-out').click(() => firebase.auth().signOut());\n\n        $btnSignOut.hide();\n        $btnSignIn.show();\n        firebase.auth().onAuthStateChanged(user => {\n            if (user) {\n                $btnSignOut.show();\n                $btnSignIn.hide();\n                $('#form-send-message input').removeAttr('disabled').attr('placeholder', 'Message');\n                $('#form-send-message button').removeAttr('disabled');\n                document.querySelector('#name').innerHTML = getUserName();\n                document.querySelector('#pfp').src = addSizeToGoogleProfilePic(getProfilePicUrl());\n            } else {\n                $btnSignOut.hide();\n                $btnSignIn.show();\n                $('#form-send-message input').attr('disabled', 'disabled').attr('placeholder', 'Please sign in to send messages');\n                $('#form-send-message button').attr('disabled', 'disabled');\n                document.querySelector('#name').innerHTML = 'Please sign in <i class=\"fas fa-arrow-right\"></i>';\n                document.querySelector('#pfp').src = 'profile_placeholder.png';\n            }\n        });\n        $('#btn-add-image').click(e => {\n            e.preventDefault();\n            e.stopPropagation();\n            const input = document.createElement('input');\n            input.type = 'file';\n            input.accept = 'image/png, image/jpeg, image/gif';\n            input.onchange = e => {\n                const file = e.target.files[0];\n                if (!file.type.match('image.*')) {\n                    alert('You can only share images');\n                    return;\n                }\n                saveImageMessage(file)\n            };\n            input.click();\n        });\n\n        $('#form-send-message').submit(e => {\n            e.preventDefault();\n            e.stopPropagation();\n            const message = e.currentTarget.querySelector('input').value;\n            e.currentTarget.querySelector('input').value = '';\n            saveMessage(message);\n        });\n\n        const toggle = () => $('.fa-expand-arrows-alt,.fa-compress-arrows-alt').toggleClass('fa-expand-arrows-alt fa-compress-arrows-alt');\n        document.addEventListener('fullscreenchange', toggle, false);\n        document.addEventListener('webkitfullscreenchange', toggle, false);\n        document.addEventListener('mozfullscreenchange', toggle, false);\n        document.addEventListener('msfullscreenchange', toggle, false);\n        const active = () => {\n            if (document.fullscreenElement != null) {\n                return true;\n            } else if (document.fullscreen) {\n                return document.fullscreen;\n            } else if (document.webkitIsFullScreen) {\n                return document.webkitIsFullScreen;\n            } else if (document.mozIsFullScreen) {\n                return document.mozIsFullScreen;\n            } else if (document.msIsFullScreen) {\n                return document.msIsFullScreen;\n            } else {\n                return false;\n            }\n        };\n\n        const $btnFullscreen = $('#btn-fullscreen').click(() => {\n            if (active()) {\n                if (document.exitFullscreen) {\n                    document.exitFullscreen();\n                } else if (document.webkitExitFullscreen) {\n                    document.webkitExitFullscreen();\n                } else if (document.mozExitFullscreen) {\n                    document.mozExitFullscreen();\n                } else if (document.msExitFullscreen) {\n                    document.msExitFullscreen();\n                }\n            } else {\n                if (document.body.requestFullscreen) {\n                    document.body.requestFullscreen();\n                } else if (document.body.webkitRequestFullscreen) {\n                    document.body.webkitRequestFullscreen();\n                } else if (document.body.mozRequestFullscreen) {\n                    document.body.mozRequestFullscreen();\n                } else if (document.body.msRequestFullscreen) {\n                    document.body.msRequestFullscreen();\n                } else {\n                    $btnFullscreen.hide();\n                    alert('Please use your browser\\'s fullscreen.');\n                }\n            }\n        });\n\n        const query = firebase.firestore()\n            .collection(room)\n            .orderBy('timestamp', 'asc')\n            .limit(25);\n        query.onSnapshot(snapshot => snapshot.docChanges().forEach(change => {\n            if (change.type === 'removed') {\n                deleteMessage(change.doc.id);\n            } else {\n                const message = change.doc.data();\n                displayMessage(change.doc.id, message.timestamp, message.name, message.text, message.profilePicUrl, message.imageUrl);\n            }\n        }));\n        document.querySelector('#container').classList.add('visible');\n    };\n    const room = window.location.hash.substring(1);\n    if (room.length === 0) {\n        const $modal = $('#no-stream-modal').modal({\n            backdrop: 'static',\n            keyboard: false\n        });\n        $('#form-submit-stream').submit(e => {\n            e.preventDefault();\n            const stream = document.querySelector('#stream-name').value;\n            if (stream.length > 0) {\n                history.pushState({}, stream, \"#\" + stream);\n                $modal.on('hidden.bs.modal', () => buildRoom(stream)).modal('hide')\n            }\n        });\n    } else {\n        buildRoom(room);\n    }\n})();\n"
    ],
    "file": "main.js"
}
