{"version":3,"sources":["main.es6"],"names":["room","window","location","hash","substring","$","attr","player","videojs","autoplay","plugins","airplayButton","hlsQualitySelector","addLanguage","addSizeToGoogleProfilePic","url","indexOf","getProfilePicUrl","firebase","auth","currentUser","photoURL","getUserName","displayName","saveMessage","messageText","firestore","collection","add","name","text","profilePicUrl","timestamp","FieldValue","serverTimestamp","error","console","saveImageMessage","file","imageUrl","then","messageRef","storage","ref","uid","id","put","fileSnapshot","getDownloadURL","update","storageUri","metadata","fullPath","deleteMessage","div","document","getElementById","parentNode","removeChild","displayMessage","picUrl","messageListElement","querySelector","container","createElement","innerHTML","firstChild","setAttribute","appendChild","style","backgroundImage","textContent","messageElement","replace","image","addEventListener","scrollTop","scrollHeight","src","Date","getTime","setTimeout","classList","focus","$btnSignIn","click","signInWithPopup","GoogleAuthProvider","$btnSignOut","signOut","hide","show","onAuthStateChanged","user","removeAttr","e","preventDefault","stopPropagation","input","type","accept","onchange","target","files","match","alert","submit","message","currentTarget","value","toggle","toggleClass","active","fullscreenElement","fullscreen","webkitIsFullScreen","mozIsFullScreen","msIsFullScreen","$btnFullscreen","exitFullscreen","webkitExitFullscreen","mozExitFullscreen","msExitFullscreen","body","requestFullscreen","webkitRequestFullscreen","mozRequestFullscreen","msRequestFullscreen","query","orderBy","limit","onSnapshot","snapshot","docChanges","forEach","change","doc","data"],"mappings":"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","sourcesContent":["const room = window.location.hash.substring(1);\n\n$('source').attr('src', 'hls/' + room + '.m3u8');\n\nconst player = videojs('#player', {\n    autoplay: 'any',\n    plugins: {\n        airplayButton: {}\n    }\n});\n\nplayer.hlsQualitySelector();\nvideojs.addLanguage('en', {\"The media could not be loaded, either because the server or network failed or because the format is not supported.\": \"Stream is currently offline, check back later.\"});\n\n\nconst addSizeToGoogleProfilePic = url => url.indexOf('googleusercontent.com') !== -1 && url.indexOf('?') === -1 ? url + '?sz=150' : url;\nconst getProfilePicUrl = () => firebase.auth().currentUser.photoURL || 'profile_placeholder.png';\nconst getUserName = () => firebase.auth().currentUser.displayName;\n\nconst saveMessage = messageText => firebase.firestore().collection(room).add({\n    name: getUserName(),\n    text: messageText,\n    profilePicUrl: getProfilePicUrl(),\n    timestamp: firebase.firestore.FieldValue.serverTimestamp()\n}).catch(error => console.error('Error writing new message to Firebase Database', error));\n\nconst saveImageMessage = file => firebase.firestore().collection(room).add({\n    name: getUserName(),\n    imageUrl: 'https://www.google.com/images/spin-32.gif?a',\n    profilePicUrl: getProfilePicUrl(),\n    timestamp: firebase.firestore.FieldValue.serverTimestamp()\n}).then(messageRef => firebase.storage().ref(firebase.auth().currentUser.uid + '/' + messageRef.id + '/' + file.name).put(file)\n    .then(fileSnapshot => fileSnapshot.ref.getDownloadURL()\n        .then(url => messageRef.update({\n            imageUrl: url,\n            storageUri: fileSnapshot.metadata.fullPath\n        })))).catch(error => console.error('There was an error uploading a file to Cloud Storage:', error));\n\nconst deleteMessage = id => {\n    const div = document.getElementById(id);\n    if (div) {\n        div.parentNode.removeChild(div);\n    }\n};\n\nconst displayMessage = (id, timestamp, name, text, picUrl, imageUrl) => {\n    const messageListElement = document.querySelector('.chat');\n    let div = document.getElementById(id);\n    // If an element for that message does not exists yet we create it.\n    if (!div) {\n        const container = document.createElement('div');\n        container.innerHTML = '<div class=\"message-container\"><div class=\"pic\"></div><div><div class=\"name\"></div><div class=\"message\"></div></div></div>';\n        div = container.firstChild;\n        div.setAttribute('id', id);\n        div.setAttribute('timestamp', timestamp);\n        messageListElement.appendChild(div);\n    }\n    if (picUrl) {\n        div.querySelector('.pic').style.backgroundImage = 'url(' + addSizeToGoogleProfilePic(picUrl) + ')';\n    }\n    div.querySelector('.name').textContent = name;\n    const messageElement = div.querySelector('.message');\n    if (text) { // If the message is text.\n        messageElement.textContent = text;\n        // Replace all line breaks by <br>.\n        messageElement.innerHTML = messageElement.innerHTML.replace(/\\n/g, '<br>');\n    } else if (imageUrl) { // If the message is an image.\n        const image = document.createElement('img');\n        image.addEventListener('load', () => messageListElement.scrollTop = messageListElement.scrollHeight);\n        image.src = imageUrl + '&' + new Date().getTime();\n        messageElement.innerHTML = '';\n        messageElement.appendChild(image);\n    }\n    // Show the card fading-in and scroll to view the new message.\n    setTimeout(() => div.classList.add('visible'), 1);\n    messageListElement.scrollTop = messageListElement.scrollHeight;\n    document.querySelector('input').focus();\n};\n\n\nconst $btnSignIn = $('#btn-sign-in').click(() => firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider()));\nconst $btnSignOut = $('#btn-sign-out').click(() => firebase.auth().signOut());\n\n$btnSignOut.hide();\n$btnSignIn.show();\n\nfirebase.auth().onAuthStateChanged(user => {\n    if (user) {\n        $btnSignOut.show();\n        $btnSignIn.hide();\n        $('input').removeAttr('disabled').attr('placeholder', 'Message');\n        $('#form-send-message button').removeAttr('disabled');\n        //saveMessagingDeviceToken();\n    } else {\n        $btnSignOut.hide();\n        $btnSignIn.show();\n        $('input').attr('disabled', 'disabled').attr('placeholder', 'Please sign in to send messages');\n        $('#form-send-message button').attr('disabled', 'disabled');\n    }\n});\n\n$('#btn-add-image').click(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = 'image/png, image/jpeg, image/gif';\n    input.onchange = e => {\n        const file = e.target.files[0];\n        if (!file.type.match('image.*')) {\n            alert('You can only share images');\n            return;\n        }\n        saveImageMessage(file)\n    };\n    input.click();\n});\n\n$('#form-send-message').submit(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    const message = e.currentTarget.querySelector('input').value;\n    e.currentTarget.querySelector('input').value = '';\n    saveMessage(message);\n});\n\nconst toggle = () => $('.fa-expand-arrows-alt,.fa-compress-arrows-alt').toggleClass('fa-expand-arrows-alt fa-compress-arrows-alt');\ndocument.addEventListener('fullscreenchange', toggle, false);\ndocument.addEventListener('webkitfullscreenchange', toggle, false);\ndocument.addEventListener('mozfullscreenchange', toggle, false);\ndocument.addEventListener('msfullscreenchange', toggle, false);\nconst active = () => {\n    if (document.fullscreenElement != null) {\n        return true;\n    } else if (document.fullscreen) {\n        return document.fullscreen;\n    } else if (document.webkitIsFullScreen) {\n        return document.webkitIsFullScreen;\n    } else if (document.mozIsFullScreen) {\n        return document.mozIsFullScreen;\n    } else if (document.msIsFullScreen) {\n        return document.msIsFullScreen;\n    } else {\n        return false;\n    }\n};\nconst $btnFullscreen = $('#btn-fullscreen').click(() => {\n    if (active()) {\n        if (document.exitFullscreen) {\n            document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n            document.webkitExitFullscreen();\n        } else if (document.mozExitFullscreen) {\n            document.mozExitFullscreen();\n        } else if (document.msExitFullscreen) {\n            document.msExitFullscreen();\n        }\n    } else {\n        if (document.body.requestFullscreen) {\n            document.body.requestFullscreen();\n        } else if (document.body.webkitRequestFullscreen) {\n            document.body.webkitRequestFullscreen();\n        } else if (document.body.mozRequestFullscreen) {\n            document.body.mozRequestFullscreen();\n        } else if (document.body.msRequestFullscreen) {\n            document.body.msRequestFullscreen();\n        } else {\n            $btnFullscreen.hide();\n            alert('Please use your browser\\'s fullscreen.');\n        }\n    }\n});\nconst query = firebase.firestore()\n    .collection(room)\n    .orderBy('timestamp', 'asc')\n    .limit(25);\n\nquery.onSnapshot(snapshot => snapshot.docChanges().forEach(change => {\n    if (change.type === 'removed') {\n        deleteMessage(change.doc.id);\n    } else {\n        const message = change.doc.data();\n        displayMessage(change.doc.id, message.timestamp, message.name, message.text, message.profilePicUrl, message.imageUrl);\n    }\n}));"],"file":"main.js"}